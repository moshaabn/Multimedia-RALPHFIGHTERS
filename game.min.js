var keys, mysound, PP, OP, OK, PK, OG, PG, BG, gov, intro; (intro = document.createElement("video")).style.display = "none", intro.setAttribute("preload", "auto"), intro.setAttribute("controls", "none"), document.getElementById("cbody").appendChild(intro), intro.src = "intro.mp4", BG = new effects("FS/BR.mp3"), OP = new effects("FS/psh3.wav"), gov = new effects("FS/GOV.mp3"), mysound = new effects("FS/spin_200ms_05.wav"), PP = new effects("FS/psh1.wav"), PK = new effects("FS/kick_H_09.wav"), PG = new effects("FS/block_L_05.wav"), OG = new effects("FS/block_L_04.wav"), OK = new effects("FS/kick_M_05.wav"), OP = new effects("FS/psh3.wav"); var images = {}, sources = { gaurd_left: "im/guard_left.png", gaurd_right: "im/guard_right.png", kick_left: "im/kick_left.png", kick_right: "im/kick_right.png", punch_left: "im/punch_left.png", punch_right: "im/punch_right.png", start_left: "im/start_left.png", start_right: "im/start_right.png", walk1_left: "im/walk1_left.png", walk1_right: "im/walk1_right.png", walk2_left: "im/walk2_left.png", walk2_right: "im/walk2_right.png", x: "im/x.jpg", y: "im/y.jpg" }, loadImages = function () { var e = 0, t = 0; for (var a in sources) sources.hasOwnProperty(a) && t++; for (var i in sources) images[i] = new Image, images[i].onload = function () { ++e >= t && initialize() }, images[i].src = sources[i] }, mainArea = { canvas: document.createElement("canvas"), background: "im/y.jpg", start: function () { this.canvas.width = 800, this.canvas.height = 600, this.context = this.canvas.getContext("2d"), document.querySelector("#cbody").appendChild(this.canvas) }, clear: function () { var e = new Image; e.src = this.background, this.context.drawImage(e, 1, 1) } }, startScreen = { start: function () { this.options = ["Start Fight", "Insructions", "About"], this.index = 0, this.interval = setInterval(checkOpt, 150), BG.sound.setAttribute("loop", "none"), BG.muted = !0; var e = BG.play(); void 0 !== e && e.then(e => { console.log("game started") }).catch(e => { console.log("game not started") }) }, stop: function () { clearInterval(this.interval) }, instruction: function () { this.timer = setInterval(inst, 30) }, back: function () { mainArea.background = "im/y.jpg", clearInterval(this.timer), BG.stop(), this.start() }, about: function () { this.timer = setInterval(about, 33) }, gameover: function () { this.timer = setInterval(gameOver, 33) } }, checkOpt = function () { var e = mainArea.context; mainArea.clear(), e.font = "30px Comic Sans MS", e.textAlign = "left"; for (var t = 0; t < 3; t++)startScreen.index == t && (e.strokeStyle = "red", e.lineWidth = 3, e.strokeText(startScreen.options[t], 70, 100 * (t + 2))), e.fillStyle = "white", e.fillText(startScreen.options[t], 70, 100 * (t + 2)); if (keys && keys[38]) startScreen.index = (startScreen.index - 1 + 3) % 3; else if (keys && keys[40]) startScreen.index = (startScreen.index + 1) % 3; else if (keys && keys[13]) { if (0 === startScreen.index) { startScreen.stop(); var a = prompt("player 1 name") || "Player1", i = prompt("player 2 name") || " player2"; gameArea.start(a, i) } 1 == startScreen.index && (startScreen.stop(), startScreen.instruction()), 2 == startScreen.index && (startScreen.stop(), startScreen.about()) } }, inst = function () { var e = mainArea.context, t = 250; startScreen.stop(), mainArea.clear(), e.textAlign = "left", e.font = "30px Impact", e.fillStyle = "white", e.fillText("Player 1 controls", 100, t), e.font = "20px Serif", e.fillText("W :moves the charachter up", 100, 275), e.fillText("A :moves the charachter Left", 100, 300), e.fillText("D :moves the charachter Right", 100, 325), e.fillText("V :Punch the enemy", 100, 350), e.fillText("B :Kick the enemy", 100, 375), e.fillText("N :Block the incoming hits", 100, 400), e.fillStyle = "white", e.font = "30px Impact", e.fillText("Player 2 controls", 400, t), e.font = "20px Serif", e.fillText("arrow up :moves the charachter up", 400, 275), e.fillText("arrow left :moves the charachter Left", 400, 300), e.fillText("arrow right :moves the charachter Right", 400, 325), e.fillText("home key :Punch the enemy", 400, 350), e.fillText("end key :kick the enemy", 400, 375), e.fillText("pg dn key :Block the incoming hits", 400, 400), keys && keys[27] && startScreen.back() }, about = function () { var e = mainArea.context; startScreen.stop(), mainArea.clear(), e.textAlign = "left", e.font = "40px Impact", e.strokeStyle = "green", e.lineWidth = 2, e.fillStyle = "white", e.fillText("Multimedia Project #2", 50, 170), e.strokeText("Multimedia Project #2", 50, 170), e.font = "25px Serif", e.fillStyle = "yellow", e.fillText("Created by :", 100, 215), e.fillStyle = "white", e.fillText("Ahmed Matter", 100, 250), e.fillText("Aser aboelkheir", 100, 275), e.fillText("Omar Elrayes", 100, 300), e.fillText("Monica Ayad", 100, 325), e.fillText("Monica Swiras", 100, 350), e.fillText("Abderlrahman Sharaf", 100, 375), e.fillText("Sherif Abdelmoneam", 100, 400), e.fillText("Mahmoud Gomaa", 100, 425), e.fillText("Osama Dabous", 100, 450), e.fillText("Mohamed Shaaban", 100, 475), e.fillText("Inspired by dr:khaled Elwzan", 100, 525), keys && keys[27] && startScreen.back() }, gameArea = { start: function (e, t) { this.myPlayer = new character(mainArea.canvas.width / 3, mainArea.canvas.height - 230, 170, 140, 40, images.start_left, e, 100), this.enemy = new character(2 * mainArea.canvas.width / 3, mainArea.canvas.height - 230, 170, 140, mainArea.canvas.width - 240, images.start_right, t, 620), this.interval = setInterval(gameAnimation, 33), mainArea.background = "im/x.jpg" }, stop: function () { clearInterval(this.interval) } }, gameAnimation = function () { keys && keys[27] && (gameArea.stop(), startScreen.back()); var e = gameArea.myPlayer, t = gameArea.enemy; if (keys && keys[65] && e.x > 5 && (e.x -= 5, e.walk || e.jump || e.punching || e.gaurd || (e.image(images.walk1_left), e.walk = !0, setTimeout(function () { e.image(images.start_left) }, 60), setTimeout(function () { e.walk = !1 }, 200))), keys && keys[37] && t.x > e.x + e.width + 5 && (t.x -= 5, t.walk || t.jump || t.punching || t.gaurd || (t.image(images.walk2_right), t.walk = !0, setTimeout(function () { t.image(images.start_right) }, 60), setTimeout(function () { t.walk = !1 }, 200))), keys && keys[68] && e.x + e.width + 5 < t.x && (e.x += 5, e.walk || e.jump || e.punching || e.gaurd || (e.image(images.walk2_left), e.walk = !0, setTimeout(function () { e.image(images.start_left) }, 60), setTimeout(function () { e.walk = !1 }, 200))), keys && keys[39] && t.x + t.width + 5 < mainArea.canvas.width && (t.x += 5, t.walk || t.jump || t.punching || t.gaurd || (t.image(images.walk1_right), t.walk = !0, setTimeout(function () { t.image(images.start_right) }, 60), setTimeout(function () { t.walk = !1 }, 200))), keys && keys[87] && !e.jump) { var a = e.y - 50; e.jump = !0, mysound.play(), timer = setInterval(function () { a >= e.y ? (clearInterval(timer), timer = setInterval(function () { e.y += 2, a <= e.y - 50 && (clearInterval(timer), e.jump = !1) }, 20)) : e.y -= 2 }, 20) } if (keys && keys[38] && !t.jump) { var i = t.y - 50; t.jump = !0, mysound.play(), timer2 = setInterval(function () { i >= t.y ? (clearInterval(timer2), timer2 = setInterval(function () { t.y += 2, i <= t.y - 50 && (clearInterval(timer2), t.jump = !1) }, 20)) : t.y -= 2 }, 20) } e.gaurd || e.punching || !keys || !keys[86] && !keys[66] || (e.punching = !0, e.width += 20, keys[86] && (PP.play(), e.image(images.punch_left)), keys[66] && (PK.play(), e.image(images.kick_left)), t.gaurd || (keys[86] && e.y < t.y + t.height && e.y + e.height / 2 > t.y && e.x + e.width >= t.x && (t.health -= 5, t.score > 0 && (t.score -= 5), e.score += 5), keys[66] && e.y + e.height / 2 < t.y + t.height && e.y + e.height > t.y && e.x + e.width >= t.x && (t.health -= 5, t.score > 0 && (t.score -= 5), e.score += 5)), setTimeout(function () { e.width -= 20, e.image(images.start_left) }, 200), setTimeout(function () { e.punching = !1 }, 300)), t.gaurd || t.punching || !keys || !keys[36] && !keys[35] || (t.punching = !0, t.width += 20, t.x -= 20, keys[36] && (OP.play(), t.image(images.punch_right)), keys[35] && (OK.play(), t.image(images.kick_right)), e.gaurd || (keys[36] && e.y < t.y + t.height && e.y + e.height > t.y && e.x + e.width >= t.x && (e.health -= 5, OP.play(), t.image(images.punch_right), e.score > 0 && (e.score -= 5), t.score += 5), keys[35] && e.y < t.y + t.height && e.y + e.height > t.y && e.x + e.width >= t.x && (e.health -= 5, OK.play(), t.image(images.kick_right), e.score >> 0 && (e.score -= 5), t.score += 5)), setTimeout(function () { t.width -= 20, t.x += 20, t.image(images.start_right) }, 200), setTimeout(function () { t.punching = !1 }, 300)), keys && keys[78] && !e.gaurd && (PG.play(), e.gaurd = !0, e.image(images.gaurd_left)), keys && !keys[78] && e.gaurd && (e.gaurd = !1, e.image(images.start_left)), keys && keys[34] && !t.gaurd && (OG.play(), t.gaurd = !0, t.image(images.gaurd_right)), keys && !keys[34] && t.gaurd && (t.gaurd = !1, t.image(images.start_right)), updateGame(), (e.health <= 0 || t.health <= 0) && (gameArea.stop(), gov.play(), BG.stop(), startScreen.gameover()) }, initialize = function () { mainArea.start(), startScreen.start() }; function character(e, t, a, i, n, r, s, l) { this.score = 0, this.scorex = l, this.height = a, this.width = i, this.x = e, this.y = t, this.healthx = n, this.name = s, this.health = 100, this.jump = !1, this.punching = !1, this.gaurd = !1, this.walk = !1, this.img = r, this.image = function (e) { this.img = e, updateGame() }, this.update = function () { var e = mainArea.context; e.font = "25px Impact", e.fillStyle = "white", e.fillText("score:" + this.score, this.scorex, 110), e.fillStyle = "red", e.fillRect(this.healthx, 40, 2 * this.health, 40), e.drawImage(this.img, this.x, this.y, this.width, this.height) } } var updateGame = function () { mainArea.clear(), gameArea.myPlayer.update(), gameArea.enemy.update() }, gameOver = function () { mainArea.clear(); var e, t = mainArea.context; gameArea.enemy.health ? (e = gameArea.enemy.name, scorew = gameArea.enemy.score) : (e = gameArea.myPlayer.name, scorew = gameArea.myPlayer.score), t.fillStyle = "white", t.font = "55px Comic Sans MS", t.textAlign = "center", t.fillText("Game Over", mainArea.canvas.width / 2, mainArea.canvas.height / 2 - 50), t.font = "45px Comic Sans MS", t.fillStyle = "red", t.fillText(e + " Wins", mainArea.canvas.width / 2, mainArea.canvas.height / 2 + 50), t.font = "30px Arial", t.fillStyle = "white", t.fillText("with score:" + scorew, mainArea.canvas.width / 2, mainArea.canvas.height / 2 + 100), t.fillStyle = "white", t.font = "30px Arial", t.fillText("Press Esc to play again", mainArea.canvas.width / 2, mainArea.canvas.height / 2 + 150), keys && keys[27] && startScreen.back() }; function effects(e) { this.sound = document.createElement("audio"), this.sound.src = e, this.sound.style.display = "none", this.sound.setAttribute("preload", "auto"), this.sound.setAttribute("controls", "none"), document.body.appendChild(this.sound), this.play = function () { this.sound.play(), this.sound.currentTime = 0 }, this.stop = function () { this.sound.pause() } } document.onkeydown = function (e) { e.preventDefault(), (keys = keys || [])[e.keyCode] = !0 }, document.onkeyup = function (e) { keys[e.keyCode] = !1 }; var playV = function () { intro.ended ? loadImages() : (mainArea.context.drawImage(intro, -10, 0, mainArea.canvas.width + 40, mainArea.canvas.height), setTimeout(playV, 20)) }; intro.onloadeddata = function () { console.log("hi htere"); var e = intro.play(); mainArea.start(), playV(), void 0 !== e && e.then(e => { console.log("game started") }).catch(e => { intro.muted = !0, intro.play() }) };